\chapter{Vısledky testù modelu}

Tato kapitola obsahuje vısledky testù modelu.
V první podkapitole jsou testy finálního modelu prostorové mapy na rùznıch datech, v dalších jsou testy modelu s rùznımi hodnotami nìkterıch klíèovıch parametrù.
\\

Samotnı test je urèen testovacím svìtem\footnote{Pøehled všech testovacích místností je v pøíloze A.},
tedy místností a hodnotami parametrù modelu.
Na základì pøedmìtù, èinností a zámìrù definovanıch ve svìtì je na zaèátku simulace vygenerován agentùv scénáø, tj. posloupnost zámìrù, které se bude snait postupnì splnit.
Scénáø do znaèné míry urèuje agentùv pohyb po svìtì.
\\

Zobrazení stavu svìta a prostorové mapy na následujících stránkách obsahuje následující objekty:

\begin{description}
  \setlength{\leftmargin}{0.5cm}
  \setlength{\itemsep}{0pt}
  \setlength{\parsep}{0pt}
  \setlength{\topsep}{0pt}
  \item[modré ètverce] - pøedmìty
  \item[menší zelené ètverce] - uzly prostorové mapy
  \item[modré krunice] - místa
  \item[modré úseèky] - náleení uzlu do místa
\end{description}


Vısledek testu závisí také na inicializaci generátoru pseudonáhodnıch èísel.
Generátor je inicializován hodnotou urèenou parametrem v souboru \texttt{Enviroment/Global.py}, co umoòuje provádìt opakovatelné experimenty.
\\


\section{Testy vısledného modelu} \label{chapter-test-final}
Model prostorové mapy popsanı v kapitole \ref{chapter-model} resp. \ref{chapter-model-el}
s vıchozím nastavením parametrù dle tabulky \ref{tab:param-el} v pøíloze B jsme otestovali v osmi rùznıch místnostech. 
Na obrázku \ref{fig:final-crazy} a \ref{fig:final-heapline} jsou zobrazeny nìkteré vısledky.
Vısledky v dalších místnostech, další vıstupní data a videa zachycující prùbìh testù jsou na pøiloeném DVD.
\\

Na obrázku \ref{fig:final-heapline} je vidìt, e rozloení uzlù kopíruje rozloení pøedmìtù.
V levém horním rohu a pravém dolním je malá hustota uzlù.
Konkrétnì obrázek \ref{fig:final-heapline-1000-uzly} ukazuje, e v dolním pravém ètverci je 36 uzlù. V tomto kroku byl celkovı poèet uzlù prostorové mapy 231.
Pøiblinì 15\% uzlù tak pokrıvá 1/4 svìta.
\\

Poblí pøedmìtù je vysoká hustota uzlù, jak ukazuje obrázek \ref{fig:final-heapline-1000-vyrez}.
Hustota uzlù se zvyšuje smìrem k pøedmìtùm.
\\

Na obrázku \ref{fig:final-heapline-1000-uzly} je vidìt, e prostorová mapa v kroku 100 obsahovala tøi místa druhé úrovnì, jedno z nich obsahovalo další dvì místa tøetí úrovnì.
V kroku 5000 obsahovala prostorová mapa další ètyøi místa, jak ukazuje obrázek \ref{fig:final-heapline-5000}.
Mapa vytvoøila dvì místa ètvrté úrovnì, jedno tøetí úrovnì a jedno druhé úrovnì.
\\

Vısledky ukazují, e model rozmisuje uzly do svìta dle rozloení pøedmìtù. Uzel pøedstavuje agentovu reprezentaci èásti prostoru.
Vysoká hustota uzlù v jedné oblasti znamená, e agent si danou oblast dobøe pamatuje. Èím vìtší hustota, tím déle si tuto znalost o prostoru zapamatuje.
\\

Postupné vytváøení míst shora, tedy nejdøíve vìtších a pozdìji menších míst, imituje naši pøedstavu,
e èlovìk si nejdøíve vytváøí hrubou pøedstavu o svém okolí a v prùbìhu èasu tuto pøedstavu konkretizuje.
Místa první úrovnì jsou nepøesné pøedstavy o oblastech typu \uv{nìkde v rohu}. Místa vyšších úrovní pøedstavují pøesnìjší znalosti o prostoru.
\\


Obrázek \ref{fig:final-crazy} ukazuje, e model se chová podobnì i v pomìrnì komplikovanıch místnostech jako je místnost CrazyRoom. Ta je reprezentována nekonvexním polygonem.
Hustota uzlù roste smìrem k poloze pøedmìtù a v takovıch oblastech vznikají místa.
\\


\newpage

\begin{figure}[p]
  \centering
  \subfloat[Krok 1000]{\label{fig:final-heapline-1000-uzly}\includegraphics[width=0.7\textwidth]{img/final/heapline1000-uzly.eps}}
  \quad
  \subfloat[Krok 1000, vıøez levého dolního ètverce]{\label{fig:final-heapline-1000-vyrez}\includegraphics[width=0.7\textwidth]{img/final/heapline1000-vyrez.eps}}
  \caption{Test vısledného modelu, místnost HeapLineRoom.}
  \label{fig:final-heapline}
\end{figure}

\newpage



\begin{figure}[p]
  \centering
  \subfloat[Místnost HeapLineRoom]{\label{fig:final-heapline-5000}\includegraphics[width=0.7\textwidth]{img/final/heapline5000.eps}}
  \quad
  \subfloat[Místnost CrazyRoom]{\label{fig:final-crazy}\includegraphics[width=0.7\textwidth]{img/final/crazy5000.eps}}
  \caption{Test vısledného modelu, krok 5000.}
  \label{fig:final-heapline}
\end{figure}


\clearpage


\section{Naplnìnost uzlu} \label{chapter-test-ag}

V tomto testu ukáeme, jak dùleitou roli hraje vliv naplnìnosti pøi urèování vzájemné odpudivosti dvou uzlù ve vzorcích
\eqref{formula:el-odpudivost} a \eqref{formula:el-odpudivost-posun}.
Provedli jsme 5000 krokù simulace v místnostech EmptyRoom a FullRoom.
\\

V prvním testu nebyla naplnìnost uzlù pøi poèítání odpudivosti vùbec brána v úvahu.
Vısledek je na obrázku \ref{fig:usage-ag-no} a ukazuje, e v tomto pøípadì model rozmisuje uzly v prostoru témìø rovnomìrnì.
Hustota uzlù je vìtší v místnosti FullRoom, protoe ta obsahuje více pøedmìtù.
\\

Na obrázku \ref{fig:usage-ag-sqrt} je hodnota parametru \param{vliv naplnìnosti}
rovna $0,8$ a naplnìnost je pøed pouitím ve vzorcích  \eqref{formula:el-odpudivost} a \eqref{formula:el-odpudivost-posun} odmocnìna.
Pøedevším na obrázku \ref{fig:usage-ag-sqrt-full} je vidìt, e hustota uzlù prostorové mapy je vìtší poblí pøedmìtù.
\\

Na obrázku \ref{fig:usage-ag-0.5} a \ref{fig:usage-ag-1} jsou vısledky testù pøi pouití pùvodních vzorcù
\eqref{formula:el-odpudivost} a \eqref{formula:el-odpudivost-posun} a hodnota parametru \param{vliv naplnìnosti} je rovna $0,5$, resp. $1,0$.
V tomto pøípadì je velkı rozdíl hustot v oblastech s pøedmìty a bez pøedmìtù.
\\

Z vısledkù testù vyplıvá, e naplnìnost uzlu hraje v modelu vıznamnou roli.
Pøedstavuje míru dùleitosti uzlu pro prostorovou mapu, resp. pamì na pøedmìty.
Zmìna parametru \param{vliv naplnìnosti} má malı vliv na rozmístìní uzlù v prostoru, resp. na rozdíl hustot v oblastech s pøedmìty a v oblastech bez pøedmìtù.
Zmìna zpùsobu vıpoètu vzájemné odpudivosti dvou uzlù má mnohem zásadnìjší vliv.
\\


Naplnìnost uzlu tak reprezentuje intenzitu zapamatované znalosti.
Oblasti s uzly s vysokou naplnìností si agent dobøe pamatuje.
Pokud se rozloení pøedmìtù v oblasti zmìní, napø. pøedmìty zmizí èi se objeví nové, trvá delší dobu, ne se prostorová mapa zmìnì pøizpùsobí.
Oblasti s uzly s malou naplnìností jsou tvárné.
\\

Pokud se v prázdné oblasti objeví novı pøedmìt, prostorová mapa se tomu rychle pøizpùsobí.
Naopak pokud pøedmìt ze svìta zmizí, prostorová mapa si bude ještì urèitou dobu pamatovat skuteènost, e tam pøedmìt byl.
\\


\begin{figure}[p]
  \centering
  \subfloat[EmptyRoom]{\includegraphics[width=0.5\textwidth]{img/usage/nousage-empty.eps}}
  \subfloat[FullRoom]{\includegraphics[width=0.5\textwidth]{img/usage/nousage-full.eps}}
  \caption{Test odpudivosti uzlù, jejich naplnìnost není brána v úvahu.}
  \label{fig:usage-ag-no}
\end{figure}

\begin{figure}[p]
  \centering
  \subfloat[EmptyRoom]{\includegraphics[width=0.5\textwidth]{img/usage/square-empty.eps}}
  \subfloat[FullRoom]{\label{fig:usage-ag-sqrt-full}\includegraphics[width=0.5\textwidth]{img/usage/square-full.eps}}
  \caption{Test odpudivosti uzlù, vliv naplnìnosti $=0,8$, naplnìnost odmocnìna.}
  \label{fig:usage-ag-sqrt}
\end{figure}

\begin{figure}[p]
  \centering
  \subfloat[EmptyRoom]{\includegraphics[width=0.5\textwidth]{img/usage/usage1-empty.eps}}
  \subfloat[FullRoom]{\includegraphics[width=0.5\textwidth]{img/usage/usage1-full.eps}}
  \caption{Test odpudivosti uzlù, vliv naplnìnosti $=1$.}
  \label{fig:usage-ag-1}
\end{figure}


\begin{figure}[p]
  \centering
  \subfloat[EmptyRoom]{\includegraphics[width=0.5\textwidth]{img/usage/usage0.5-empty.eps}}
  \subfloat[FullRoom]{\includegraphics[width=0.5\textwidth]{img/usage/usage0.5-full.eps}}
  \caption{Test odpudivosti uzlù, vliv naplnìnosti $=0,5$.}
  \label{fig:usage-ag-0.5}
\end{figure}



\newpage

\section{Pøesnost mapy}
Jedním z objektivních kritérií modelu je pøesnost mapy, tj. nakolik odpovídá \uv{realitì} virtuálního svìta.

\begin{definition}[Nauèenost pøedmìtu]
V prùbìhu simulace agent vidí a pouívá pøedmìty, prostorová mapa pak dostává vjemy, které to odráejí.
Nauèenost pøedmìtu je vlastnost vyjadøující poèet a intenzitu vjemù daného pøedmìtu.
Na zaèátku simulace je rovna nule, v prùbìhu simulace roste. Vdy, kdy je vytvoøen vjem pøedmìtu, je nauèenost pøedmìtu zvıšena o intenzitu vjemu.
Nauèenost pøedmìtu v èase je neklesající funkce.
\end{definition}

Na konci simulace máme k dispozici mnoinu pøedmìtù, jejich polohu a nauèenost\footnote{Tyto informace jsou nezávislé na prostorové mapì.}.
Prostorová mapa má k dispozici mnoinu uzlù, jejich polohu a naplnìnost. Pøedpokládáme, e naplnìnost uzlù bude odráet nauèenost pøedmìtù.
\\


Vizualizace dat pro místnost FullRoom je na obrázku \ref{fig:test-heatmap}. Vısledky v dalších místnostech jsou na pøiloeném DVD.
Obrázek \ref{fig:test-heatmap-obj} ukazuje nauèenost pøedmìtù, obrázek \ref{fig:test-heatmap-uzly} naplnìnost uzlù.
Vısledky jsou velmi podobné, naplnìnost uzlù je spojitìjší.
To je zpùsobeno pøedevším tím, e poèet uzlù je vıraznì vìtší ne poèet pøedmìtù (240 uzlù, 33 pøedmìtù).
\\

\begin{figure}[h]
  \centering
  \subfloat[Nauèenost pøedmìtù]{\label{fig:test-heatmap-obj}\includegraphics[width=0.5\textwidth]{img/heatmap/predmet.eps}}
  \subfloat[Naplnìnost uzlù]{\label{fig:test-heatmap-uzly}\includegraphics[width=0.5\textwidth]{img/heatmap/uzel.eps}}
  \caption{Vizualizace naplnìnosti uzlù a nauèenosti pøedmìtù.}
  \label{fig:test-heatmap}
\end{figure}


Náš pøedpoklad je správnı, uzly prostorové mapy, resp. jejich naplnìnost se blíí nauèenosti pøedmìtù.
To znamená, e popsanı model prostorové mapy odráí èetnost vjemù nejen rozloením uzlù, ale i jejich naplnìností.
Vısledky nejsou však zcela identické, rozmístìní uzlù a jejich naplnìnost vykazuje urèité zkreslení.
Osamocenı pøedmìt umístìnı stranou od ostatních se pøi tomto zpùsobu vizualizace témìø neprojeví.
\\


Dalším monım mìøítkem je pøesnost zapamatovanıch poloh pøedmìtù.
V kadém kroku simulace mùeme urèit polohu, o ní se agent domnívá, e na ní pøedmìt je.
Tuto domnìlou polohu mùeme porovnat se skuteènou polohou pøedmìtu.
\\

Na obrázku \ref{fig:test-error} je zobrazen vıvoj rozdílu mezi realitou a agentovou prostorovou mapu v
èase\footnote{Vısledky v dalších místnostech jsou opìt na pøiloeném DVD.}.
Na ose $y$ je zobrazena chyba mapy, tj. vzdálenost mezi skuteènou a domnìlou polohou pøedmìtu, její rozsah se v kadé místnosti liší.
Hodnota grafu v jednom kroku je prùmìrná chyba všech pøedmìtù.
\\


Relativní chyba vzhledem k velikosti místnosti se pohybuje øádovì v jednotkách procent.
V místnostech CrazyRoom, FullRoom, HeapRoom, HeapLineRoom a SmallRoom má chyba klesající tendenci.
V místnostech Corridor, Lobby a EmptyRoom velikost chyby neustále kolísá.
\\

Vısledky ukazují, e místnosti obsahující vìtší poèet pøedmìtù, uspoøádanıch do hromad, se mapa uèí dobøe.
V prùbìhu èasu pøesnost svıch znalostí o prostoru zpøesòuje. 
\\


V EmptyRoom, tedy prázdné místnosti pouze s jedním pøedmìtem, se polohu jediného pøedmìtu mapa nauèí do urèité míry a pak ji ji nezpøesòuje.
To odpovídá naší pøedstavì,
e prostor témìø bez záchytnıch bodù si èlovìk pamatuje nepøesnì. Špatnì se o nìm uèí prostorové znalosti, nebo je není k èemu vztáhnout.
\\



\begin{figure}[p]
  \centering
  \subfloat[Místnost Corridor]{\includegraphics[width=0.5\textwidth]{img/error/corridor.eps}}
  \subfloat[Místnost CrazyRoom]{\includegraphics[width=0.5\textwidth]{img/error/crazy.eps}}

  \subfloat[Místnost EmptyRom]{\includegraphics[width=0.5\textwidth]{img/error/empty.eps}}
  \subfloat[Místnost FullRoom]{\includegraphics[width=0.5\textwidth]{img/error/full.eps}}
  
  \subfloat[Místnost HeapRoom]{\includegraphics[width=0.5\textwidth]{img/error/heap.eps}}
  \subfloat[Místnost Lobby]{\includegraphics[width=0.5\textwidth]{img/error/lobby.eps}}
  \caption{Prùmìrná chyba polohy pøedmìtù v èase.}
  \label{fig:test-error}
\end{figure}



\newpage

\section{Test limitù míst}
V kapitole \ref{chapter-place-detect} byl popsán mechanismus vytváøení míst.
Model prostorové mapy je tak schopen rozpoznat oblasti s vyšší hustotou uzlù a vytvoøit v takové oblasti místo.
V tomto testu jsme se rozhodli vyzkoušet vliv parametrù \param{rychlost klesání $\varrho$}, \param{limit vzniku podmísta} a \param{limit zapomenutí místa}.
Test jsme provedli s nastavením parametrù tak, aby došlo k vytvoøení více míst, jejich hodnoty jsou v tabulce \ref{tab:test-mist}.
Provedli jsme 4000 krokù simulace v místnosti EmptyRoom a HeapRoom.
\\

\begin{table}[h!]
\begin{center}
\begin{tabular}{lcc}\toprule[0.5pt]

Parametr & Vıchozí hodnota & Testovaná hodnota \\
\midrule[0.2pt]

\param{Rychlost klesání} $\varrho$ & 0,1 & 0,05 \\

\param{Limit vzniku podmísta} & 1500 & 1000 \\

\param{Limit zapomenutí} místa & 500 & 300 \\

\bottomrule[0.5pt]
\end{tabular}
\end{center}
\centering
\caption{Hodnoty parametrù testu}
\label{tab:test-mist}
\end{table}

Vısledky testu s vıchozími hodnotami parametrù jsou na obrázku \ref{fig:test-places-ll}, vısledky testu se zmìnìnımi parametry jsou na obrázku \ref{fig:test-places-lh}.
Je vidìt, e zmìna testovanıch parametrù zpùsobila vznik více míst. I v témìø prázdné místnosti vznikla tøi místa.
\\

Vedlejším efektem však bylo vytvoøení míst i tam, kde jsme je neoèekávali a nechtìli.
Zvıraznìná místa na obrázku \ref{fig:test-places-lh-heap} nevznikla jako pøímı dùsledek vìtší hustoty uzlù.
Ke svému vzniku spotøebovala mnoství odpudivosti nahromadìné v uzlech v tìsné blízkosti jinıch míst, jakési \uv{zbytkové mnoství odpudivosti}.
\\

Tato místa nenaplòují naši pøedstavu o tom, jak èlovìk vnímá shluky pøedmìtù a jak si vjemy seskupuje.
Reprezentují oblasti pojmenovatelné jako  \uv{hned vedle té hromady pøedmìtù} a \uv{mezi zdí a hromadou pøedmìtù}.
Lidé jistì pouívají taková oznaèení oblastí, ale nepøedstavují si pod nimi místo, ke kterému by bylo moné vztáhnout další prostorové informace.
Obì pojmenování obsahují odkaz na opravdové místo.
\\




\begin{figure}[p]
  \centering
  \subfloat[EmptyRoom]{\includegraphics[width=0.5\textwidth]{img/places/lh-empty.eps}}
  \subfloat[HeapRoom]{\includegraphics[width=0.5\textwidth]{img/places/lh-heap.eps}}
  \caption{Test vytváøení míst, vıchozí hodnoty parametrù.}
  \label{fig:test-places-ll}
\end{figure}

\begin{figure}[p]
  \centering
  \subfloat[EmptyRoom]{\includegraphics[width=0.5\textwidth]{img/places/ll-empty.eps}}
  \subfloat[HeapRoom]{\label{fig:test-places-lh-heap}\includegraphics[width=0.5\textwidth]{img/places/ll-heap.eps}}
  \caption{Test vytváøení míst, zmìnìné hodnoty parametrù.}
  \label{fig:test-places-lh}
\end{figure}





\section{Test dynamického svìta}
Model prostorové mapy je vytvoøen tak, aby se dokázal pøizpùsobit mìnícímu se prostøedí.
Provedli jsme test v místnosti SwitchRoom, kterou jsme navrhli právì pro tento úèel.
V místnosti dojde ke dvìma zmìnám, v kroku 1500 je odebrána èást pøedmìtù a v kroku 4000 je nìkolik z nich vráceno zpìt a vytvoøeno nìkolik
novıch\footnote{Místnost SwitchRoom a její zmìny jsou zobrazeny v pøíloze A.}.
\\

Vısledek testu je na obrázcích \ref{fig:test-dyn-nc} a \ref{fig:test-dyn}.
Obrázek \ref{fig:test-dyn-nc} ukazuje poèet uzlù prostorové mapy v èase.
Poèet uzlù zpoèátku simulace rychle roste. Po odebrání pøedmìtù v kroku 1500 se jeho rùst zastaví a v kroku 3000 zaèíná pomalu klesat.
V kroku 4000 jsou do svìta pøidány další pøedmìty a poèet uzlù opìt zaène rùst.
\\

Obrázek \ref{fig:test-dyn} ukazuje vytvoøení místa v kroku 4497, co je reakce prostorové mapy na pøidání pøedmìtù v kroku 4000.
Nové místo tedy vzniklo pøiblinì tøikrát pomaleji, ne vzniká první místo.
Prùbìh testu je lépe vidìt na videu, které je na pøiloeném DVD.
Vısledky testu ukazují, e model prostorové mapy se skuteènì umí pøizpùsobit pøidání novıch pøedmìtù do svìta.
\\

\begin{figure}[h!]
  \centering
  \includegraphics[width=1.0\textwidth]{img/dyn/nc.eps}
  \caption{Poèet uzlù prostorové mapy v èase, místnost SwitchRoom.}
  \label{fig:test-dyn-nc}
\end{figure}

\begin{figure}[!h]
  \centering
  \subfloat[Krok 4001]{\includegraphics[width=0.6\textwidth]{img/dyn/step4001.eps}}
  
  \subfloat[Krok 4400]{\includegraphics[width=0.6\textwidth]{img/dyn/step4497.eps}}
  \caption{Test dynamického svìta, v kroku 4000 jsou pøidány pøedmìty do pravého dolního rohu, v kroku 4400 tam ji je místo.}
  \label{fig:test-dyn}
\end{figure}