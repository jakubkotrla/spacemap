\section{Model zaloenı na Kohonenovì mapì}

Vìtšina modelù pamìti, zmínìnıch v tøetí kapitole, vyuívá samoorganizující Kohonenovy mapy [literatura]. 
\\

?? Jak funguje KM ??
\\

Kohonenova mapa by mìla splòovat naše poadavky. Umí rozmístit uzly do hustoty odpovídající rozmístìní pøedmìtù v prostoru.
Umí se uèit online, kadı vjem agenta je moné chápat jako prvek trénovací mnoiny dat. Jeví se tedy jako ideální.
Navrhli jsme tedy model vrstvy uzlù zaloenı na Kohonenovì mapì.
\\

?? definice vsech parametru ??
\\




Na zaèátku je prostor pokryt Kohonenovou mapou - ètvercovou sítí. Hustota uzlù je parametr modelu.
Pokadé, kdy je vjem, pøedán ke zpracování do Kohonen Map Layer, provede se trénování Kohonenovy mapy dle algoritmu \ref{alg:km-uceni}.
\\

\begin{figure}[h]
  \centering
  \includegraphics[width=0.5\textwidth]{img/kml/kml-start-grid.eps}
  \caption{Poèáteèní pokrytí svìta uzly}
  \label{fig:kml-start}
\end{figure}


\begin{algorithm}[h!]
\caption{Zpracování vjemu}
\label{alg:km-uceni}
\begin{algorithmic}[1]
\State $node \gets$ vyhrávající uzel (tedy nejbliší k poloze vjemu)
\State $queue \gets \emptyset$
\State $queue \gets node$
\While{$queue\not= \emptyset$}
	\State $n \gets first(queue)$
	\State $queue \gets queue  \setminus <n>$
	\State Trénování $n$ dle vzorce \ref{formula:km-uceni} \label{alg:km-uceni-vzorec}
	\State $queue \gets$ sousedi $n$ (pokud nebyli ješte trénováni)
\EndWhile
\State vjem je pøedán vrstvì uzlù k dalšímu zpracování
\end{algorithmic}
\end{algorithm}

Pøi trénování je v algoritmu na øádce \ref{alg:km-uceni-vzorec} pouit vzorec

\begin{equation} 
\Delta xy(n, vjem) = coef_{neighbour}(n, node) \times coef_{learn} \times dist(n, vjem)
\label{formula:km-uceni}
\end{equation}

kde \(coef_{neighbour}\) je vzdálenost mezi vyhrávajícím uzlem a právì trénovanım uzlem v Kohonenovì mapì,
\emph{dist} je vzdálenost uzlu od vjemu v prostoru a \(coef_{learn}\) je parametr modelu.
Poloha uzlu \emph{n} je zmìnìna o \(\Delta xy(n, vjem)\).
Tímto algoritmem se uzly Kohonen Map Layer v prùbìhu uèení/vnímání pøibliují k pøedmìtùm.
\\

Problém, které by mohl nastat je, e se sí pro naše potøeby "pøeuèí" - uzly se èasem všechny pøesunou k pøedmìtùm a prostor bez pøedmìtù zùstane prázdnı, bez uzlù.
Navrhli jsem dvì moná øešení:
\begin{CompactItemize}
\item Base objects - pøidání umìlıch objektù, které se budou snait dret pùvodní rozloení uzlù KM
\item Odpudivost uzlù - uzly mapy se budou vzájemnì odpuzovat, aby se nenahromadily všechny na jedno místo
\end{CompactItemize}

Vıše zmínìná øešení jsme vyzkoušeli v jednoduché ètvercové místnosti.
\\

\subsection{Base objects}
Toto øešení pøidává do svìta umìlé pøedmìty, tzv. base objects.
Tyto umìlé pøedmìty musí mít niší atraktivitu ne reálné pøedmìty, aby je nepøebily a mapa se mohla nìco nauèit.
\\

Base objects jsou do svìta pøidány na zaèátku, pøi vytváøení ètvercové sítì. V kadém místì, kde je uzel sítì, je vytvoøen jeden base object.
Agent je bude vnímat stejnì jako ostatní pøedmìty, v prùbìhu simulace budou k sobì pøitahovat uzly sítì stejnì jako reálné pøedmìty.
Tím by mìly udret Kohonenovu mapu roztaenou i v místech, kde reálné pøedmìty nejsou.
\\

?? Vısledek testu OBR. ??
\\

V pøípadì base objects se ukázalo, e øešení nevyhovuje. Mapa se stahuje do støedu místnosti bez ohledu na vliv base objects.
\\

\subsection{Odpudivost uzlù} \label{s:km-odpudivost}
Do modelu jsme pøidali odpudivost uzlù sítì. V kadém kroku simulace se uzly, které jsou pøíliš blízko u sebe, odpuzují.
V kadém kroku simulace je proveden proces ref. Vzájemná odpudivost dvou uzlù závisí na jejich vzdálenosti a jejich naplnìnosti.
\\

Naplnìnost uzlu \footnote{Naplnìnost uzlu $node$ budeme dále ve vzorcích oznaèovat znakem $\mu(node)$}
je souèet intenzit všech jeho vazeb na pamìové stopy. Pøedstavuje míru dùleitosti uzlu pro pamì na pøedmìty.
Èím více pamìovıch stop vyuívá uzel a èím intenzivnìjší jsou, tím ménì by se mìla mìnit jeho poloha.
Uzel s vysokou naplnìností bude v místì, kde je hodnì pøedmìtù.
V takovıch místech by hustota uzlù mìla bıt vìtší a proto je nutné, aby v takovıch místech byla vzájemná odpudivost uzlù menší.
\\

\begin{equation} 
odpudivost(n_i, n_j) = \frac{ coef }{ dist(n_i, n_j)^2 \times \mu(n_i) \times \mu(n_j) } 
\label{formula:km-odpudivost}
\end{equation}
\\

Naplnìnost uzlu lze pøi urèování vzájemné odpudivosti chápat jako analogii k hmotnosti tìles, s tím rozdílem,
e odpudivost dvou uzlù je nepøímo úmìrná souèinu jejich naplnìností. Odpudivost je dána vzorcem \ref{formula:km-odpudivost},
kde \emph{coef} je parametr modelu.
V kadém kroku simulace je spoètena vzájemná odpudivost uzlù. Tím jsou urèeny všechny odpudivé síly, které na uzly pùsobí.
Poloha uzlù je pak upravena dle tìchto sil.
\\

Vzdálenost uzlù je moné mìøit dvìma zpùsoby: jejich vzdáleností ve virtuálním svìtì èi jejich vzdáleností v Kohonenovì mapì.
Smìr odpuzujících sil je v obou pøípadech  urèen z jejich vzájemné polohy.
\\

?? Vısledky testù - OBR ??
\\

V obou pøípadech dojde k deformaci mapy do stavu, kdy její následující uèení nedává smysl.
Sí se pøekroutí tak, e uzly, které jsou ve virtuálním svìtì vedle sebe, jsou v síti daleko a obrácenì.
\\

??? Podrobnìji vysvìlit ??? , vıøez z obrázku vısledku
\\

Døíve zmínìnı problém pøeuèení skuteènì nastal a dvì velmi rozdílná øešení jej nedokázala uspokojivì vyøešit. Model zaloenı na Kohonenovì mapì jsme tedy zamítli.
\\